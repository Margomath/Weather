# Weather

Приложение предназначено для определения погоды

## Проектирование сервиса

Язык программирования - Python

Пользовательский интерфейс: сайт

Формат ответа: со стороны сервера приходит ответ, формат которого описан в документации API: https://openweathermap.org/current

`{
  "coord": {"lon": -122.08,"lat": 37.39},
  "weather": [
    {
      "id": 800,
      "main": "Clear",
      "description": "clear sky",
      "icon": "01d"
    }
  ],
  "base": "stations",
  "main": {
    "temp": 282.55,
    "feels_like": 281.86,
    "temp_min": 280.37,
    "temp_max": 284.26,
    "pressure": 1023,
    "humidity": 100
  },
  "visibility": 16093,
  "wind": {
    "speed": 1.5,
    "deg": 350
  },
  "clouds": {
    "all": 1
  },
  "dt": 1560350645,
  "sys": {
    "type": 1,
    "id": 5122,
    "message": 0.0139,
    "country": "US",
    "sunrise": 1560343627,
    "sunset": 1560396563
  },
  "timezone": -25200,
  "id": 420006353,
  "name": "Mountain View",
  "cod": 200
}`

Представление данных: ответ от API подставляется в шаблон:

    "Город: %s"
    "Температура: %s F"
    "Влажность: %s процентов"
    "Давление: %s кПа"
    "Скорость ветра: %s м/с"
    "Описание: %s"
    "Рекомендуем надеть: %s"

### Ход работы программы

1. При запуске определяется наличие файла с набором стран и городов. При отсутствии - скачивается автоматически с http://bulk.openweathermap.org/sample/city.list.json.gz

2. Генерируется список стран и городов, выполняется формирование шаблона главной веб-страницы

3. На первом этапе пользователю необходимо выбрать страну из списка и нажать "Submit country", подгрузится список городов этой страны

4. На следующем шаге пользователь выбирает из списка город, нажимает "Submit city"

5. Делается запрос погоды в данном городе, ответ от API представляется в виде, описанном в предыдущем разделе

6. На основании погодных условий подбирается рекомендация одежды для пользователя

7. Пользователь перенаправляется на страницу с результатами


### Установка

pip3 install requests

pip3 install flask

pip3 install flask_wtf

## Запуск

python3 run.py


## Реализация «задачи со звёздочкой»

Основой рекомендательного сервиса служит логика дерева решений, изображенного на рисунке. 

Решающими факторами при добавлении того или иного предмета гардероба в рекомендательный набор являются: температура (главный фактор), наличие дождя, скорость ветра (логика рекомендации зонта или дождевика), а также общее состояние погоды (в случае ясного неба и высокой температуры будет рекомендовано надеть солнцезащитные очки и бейсболку). 

При построении решающего дерева во внимание была принята необходимость обеспечения минимальной глубины и максимальная сбалансированность. Таким образом достигается наименьшее количество проверок.

![Alt text](pic.jpg?raw=true")